C51 COMPILER V8.06   MAIN                                                                  12/02/2011 20:20:39 PAGE 1   


C51 COMPILER V8.06, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /**********************HL-1ʵ鿪************************
   2          *  ƽ̨HL-1 V6.2 + Keil U3 + STC89C52RD
   3          *  ˾۾ӿƼ޹˾
   4          *  Աhttp://shop37031453.taobao.com       
   5          *  վwww.hlmcu.com
   6          *  д۾
   7          *  ڣ2008-8-08
   8          *   QQ : 121350852 398115088
   9          *  :11.0592MHZ
  10          *  ˵ѿԴṩԴֱӵ۾̳
  11          *  ̳http://hjdz.5d6d.com
  12          ******************************************************************/
  13          //12864ҺڳʱԱȶѾãûʹõʱܽſɲýκζʵΪ
  14          //ݶ12864ҺԼҺԱȶȵڵλӿڵ·ûʹ׵12864ҺɲùҺĵ
             -
  15          //ܽվͿԡЩҺıȽϴûʹõʱɽҺĵ1920ŵıⲻӣ
  16          //LCD12864ʵʱõUSBӿڹʱѹпܲLCD12864ʾ׻һ㣬һ
             -//һ㣬5VֻϵĵԴӵϣлл⡣
  17          #include <reg51.h>
  18          #include <intrins.h>
  19                  
  20          #define uchar unsigned char
  21          #define uint  unsigned int
  22          /*TS12864A-3 ˿ڶ*/
  23          #define LCD_data  P0             //ݿ
  24          sbit LCD_RS  =  P1^0;            //Ĵѡ 
  25          sbit LCD_RW  =  P1^1;            //Һ/д
  26          sbit LCD_EN  =  P2^5;            //Һʹܿ
  27          sbit LCD_PSB =  P1^2;            ///ʽ
  28          sbit wela    =  P2^6;
  29          sbit dula    =  P2^7;
  30          
  31          uchar code dis1[] = {"۾"};
  32          uchar code dis2[] = {"www.HLMCU.com"};
  33          uchar code dis3[] = {"HL-1ѧϰ "};
  34          uchar code dis4[] = {"õѡ "};
  35          
  36          #define delayNOP(); {_nop_();_nop_();_nop_();_nop_();};
  37          uchar IRDIS[2];
  38          uchar IRCOM[4];
  39          void delay0(uchar x);  //x*0.14MS
  40          void beep();
  41          void  dataconv();
  42          void lcd_pos(uchar X,uchar Y);  //ȷʾλ
  43          /*******************************************************************/
  44          /*                                                                 */
  45          /*  ʱ                                                       */
  46          /*                                                                 */
  47          /*******************************************************************/
  48          void delay(int ms)
  49          {
  50   1          while(ms--)
  51   1              {
  52   2            uchar i;
  53   2                for(i=0;i<250;i++)  
C51 COMPILER V8.06   MAIN                                                                  12/02/2011 20:20:39 PAGE 2   

  54   2                 {
  55   3                  _nop_();                       
  56   3                      _nop_();
  57   3                      _nop_();
  58   3                      _nop_();
  59   3                 }
  60   2              }
  61   1      }               
  62          /*******************************************************************/
  63          /*                                                                 */
  64          /*LCDæ״̬                                                    */
  65          /*lcd_busyΪ1ʱæȴlcd-busyΪ0ʱ,Удָݡ      */
  66          /*                                                                 */
  67          /*******************************************************************/
  68          bit lcd_busy()
  69           {                          
  70   1          bit result;
  71   1          LCD_RS = 0;
  72   1          LCD_RW = 1;
  73   1          LCD_EN = 1;
  74   1          delayNOP();
  75   1          result = (bit)(P0&0x80);
  76   1          LCD_EN = 0;
  77   1          return(result); 
  78   1       }
  79          /*******************************************************************/
  80          /*                                                                 */
  81          /*дָݵLCD                                                  */
  82          /*RS=LRW=LE=壬D0-D7=ָ롣                             */
  83          /*                                                                 */
  84          /*******************************************************************/
  85          void lcd_wcmd(uchar cmd)
  86          {                          
  87   1         while(lcd_busy());
  88   1          LCD_RS = 0;
  89   1          LCD_RW = 0;
  90   1          LCD_EN = 0;
  91   1          _nop_();
  92   1          _nop_(); 
  93   1          P0 = cmd;
  94   1          delayNOP();
  95   1          LCD_EN = 1;
  96   1          delayNOP();
  97   1          LCD_EN = 0;  
  98   1      }
  99          /*******************************************************************/
 100          /*                                                                 */
 101          /*дʾݵLCD                                                  */
 102          /*RS=HRW=LE=壬D0-D7=ݡ                               */
 103          /*                                                                 */
 104          /*******************************************************************/
 105          void lcd_wdat(uchar dat)
 106          {                          
 107   1         while(lcd_busy());
 108   1          LCD_RS = 1;
 109   1          LCD_RW = 0;
 110   1          LCD_EN = 0;
 111   1          P0 = dat;
 112   1          delayNOP();
 113   1          LCD_EN = 1;
 114   1          delayNOP();
 115   1          LCD_EN = 0; 
C51 COMPILER V8.06   MAIN                                                                  12/02/2011 20:20:39 PAGE 3   

 116   1      }
 117          /*******************************************************************/
 118          /*                                                                 */
 119          /*  LCDʼ趨                                                  */
 120          /*                                                                 */
 121          /*******************************************************************/
 122          void lcd_init()
 123          { 
 124   1      
 125   1          LCD_PSB = 1;         //ڷʽ
 126   1          
 127   1          lcd_wcmd(0x34);      //ָ
 128   1          delay(5);
 129   1          lcd_wcmd(0x30);      //ָ
 130   1          delay(5);
 131   1          lcd_wcmd(0x0C);      //ʾع
 132   1          delay(5);
 133   1          lcd_wcmd(0x01);      //LCDʾ
 134   1          delay(5);
 135   1      }
 136          /*********************************************************/
 137          /*                                                                                                               */
 138          /*                                                                                 */
 139          /*                                                       */
 140          /*********************************************************/
 141            main()
 142           {
 143   1          uchar i;
 144   1          delay(10);                 //ʱ
 145   1          wela=0;
 146   1              dula=0; 
 147   1          lcd_init();                //ʼLCD             
 148   1        
 149   1          lcd_pos(0,0);             //ʾλΪһеĵ1ַ
 150   1           i = 0;
 151   1          while(dis1[i] != '\0')
 152   1           {                         //ʾַ
 153   2             lcd_wdat(dis1[i]);
 154   2             i++;
 155   2           }
 156   1          lcd_pos(1,0);             //ʾλΪڶеĵ1ַ
 157   1           i = 0;
 158   1          while(dis2[i] != '\0')
 159   1           {
 160   2             lcd_wdat(dis2[i]);      //ʾַ
 161   2             i++;
 162   2           }
 163   1               lcd_pos(2,0);             //ʾλΪеĵ1ַ
 164   1           i = 0;
 165   1          while(dis3[i] != '\0')
 166   1           {
 167   2             lcd_wdat(dis3[i]);      //ʾַ
 168   2             i++;
 169   2           }
 170   1               lcd_pos(3,0);             //ʾλΪеĵ1ַ
 171   1           i = 0;
 172   1          while(dis4[i] != '\0')
 173   1           {
 174   2             lcd_wdat(dis4[i]);      //ʾַ
 175   2             i++;
 176   2           }
 177   1           while(1);
C51 COMPILER V8.06   MAIN                                                                  12/02/2011 20:20:39 PAGE 4   

 178   1      }
 179          
 180          
 181          
 182          /*********************************************************/
 183          /*                                                                                                               */
 184          /* ʱx*0.14msӳ                                                                    */
 185          /*                                                       */
 186          /*********************************************************/
 187          
 188          void delay0(uchar x)    //x*0.14MS
 189          {
 190   1        uchar i;
 191   1        while(x--)
 192   1       {
 193   2        for (i = 0; i<13; i++) {}
 194   2       }
 195   1      }
 196          /*********************************************************/
 197          /*                                                       */
 198          /* 趨ʾλ                                          */
 199          /*                                                       */
 200          /*********************************************************/
 201          void lcd_pos(uchar X,uchar Y)
 202          {                          
 203   1         uchar  pos;
 204   1         if (X==0)
 205   1           {X=0x80;}
 206   1         else if (X==1)
 207   1           {X=0x90;}
 208   1         else if (X==2)
 209   1           {X=0x88;}
 210   1         else if (X==3)
 211   1           {X=0x98;}
 212   1         pos = X+Y ;  
 213   1         lcd_wcmd(pos);     //ʾַ
 214   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    302    ----
   CONSTANT SIZE    =     53    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
